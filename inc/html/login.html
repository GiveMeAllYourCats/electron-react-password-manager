<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>Password App</title>
    <link rel="stylesheet" href="../css/bootstrap.css">
    <link rel="stylesheet" href="../css/bootstrap-theme.css">
    <link rel="stylesheet" href="../css/extra.css">
  </head>
  <body>
    <div class="container">
      <h2 id="titletext" class="form-signin-heading text-center">Please sign in</h2>
      <div class="form-signin">
        <label for="inputPassword" class="sr-only">Password</label>
        <input type="password" id="inputPassword" class="form-control" placeholder="Password" required>
        <input type="password" id="inputPassword2" class="form-control" placeholder="Password Again" required>
        <div id="enctype" class="form-group">
          <label for="sel1">Encryption Type:</label>
          <select class="form-control" id="sel1">
            <option bits=512>Light       - RSA 512  bits</option>
            <option bits=1048>Medium     - RSA 1048 bits</option>
            <option bits=2048>Strong     - RSA 2048 bits</option>
            <option bits=4096>Impossible - RSA 4096 bits</option>
          </select>
          <br>
          <label for="sel1">Hash Method:</label>
          <select class="form-control" id="sel2">
            <option iterations=100000 count=140>Light      - 100k times 140 length</option>
            <option iterations=200000 count=270>Medium     - 200k times 270 length</option>
            <option iterations=300000 count=420>Strong     - 300k times 420 length</option>
            <option iterations=400000 count=560>Impossible - 400k times 560 length</option>
          </select>
        </div>
        <button class="btn btn-lg btn-primary btn-block signin" type="submit">Sign in</button>
      </div>
    </div>
  </body>
  
  <script>
    window.$ = window.jQuery = require('../js/jquery.js');
    const {ipcRenderer} = require('electron');
    const notifier = require('node-notifier');
    const path = require('path');
    require('../js/bootstrap.js');
    require('../js/pubsub.js');
  </script>
    
  <script>
    $('.signin').click(() => {
      login()
    });
    
    $('#inputPassword').keypress(e => {
      if (e.which == 13) login()
    });
    $(document).ready(() => {
      $('#inputPassword').focus()
    });
    
    const replied = () => {
      $('#inputPassword').attr('disabled','disabled');
      $('#inputPassword2').attr('disabled','disabled');
      $('#sel1').attr('disabled','disabled');
      $('.signin').attr('disabled','disabled');
      setTimeout(() => {
        $('#inputPassword').val("").removeAttr('disabled');
        $('#inputPassword2').val("").removeAttr('disabled');
        $('.signin').removeAttr('disabled');
        $('#sel1').removeAttr('disabled');
        setTimeout(() => {
          $('#inputPassword').focus()
        },10);
      },1000);
    }
     
    const login = () => {
      ipcRenderer.send('login', {pass:$('#inputPassword').val(),pass2:$('#inputPassword2').val(),bits:$('#sel1 option:selected').attr('bits'),pbkd2f: {iterations:$('#sel2 option:selected').attr('iterations'),count:$('#sel2 option:selected').attr('count')}});
    }
    
    $(()=>{
      ipcRenderer.send('readylogin');
    })
    
    ipcRenderer.on('firsttime', (event, firsttime) => {
      if(firsttime){
        $('#titletext').html("Welcome! Please create a master password.")
      }else{
        $('#enctype').hide()
        $('#inputPassword2').hide()
      }
    })
  </script>
</html> 
  